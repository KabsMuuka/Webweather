<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/all_cities.css" />
    <title>reterived data</title>
  </head>
  <body>
    <div class="container">
      <header>
        <p class="title">Weather App</p>
        <p class="citation">Weather api Provided By weatherapi.com/</p>
      </header>
      <a href="./index.html"><button>back</button></a>

      <main>
        <h2 id="title_header">Weather data per City</h2>
        <div id="weatherResults"></div>
      </main>

      <script>
        try {
          const weatherResults = document.getElementById("weatherResults");
          //fetching weather data saved in the databaase
          async function fetchData() {
            const response = await fetch("http://localhost:3000/storedData");
            const weatherResponse = await response.json();
            //iterating an array of objects fetched from DB containing weatherResponse data.
            weatherResponse.forEach((weather) => {
              //create weathercard div element
              const weathercard = document.createElement("div");
              weathercard.classList.add("weather_card");
              //for each weather_card show the following information
              weathercard.innerHTML = `
            <p><strong>City :</strong> ${weather.name}</p>
            <p><strong>Country :</strong> ${weather.country}</p>
            <p><strong>Temp_c :</strong>  ${weather.temp_C} 'c</p>
            <p><strong>Condition :</strong>  ${weather.text}</p>
            <p><strong>Local time :</strong> ${new Date(
              weather.localtime
            ).toLocaleString()}</p>
             `;
              weatherResults.appendChild(weathercard);
            });
          }
        } catch (error) {
          console.log(error);
        }
        fetchData();
      </script>

      <footer>
        <p>&copy 2024</p>
        <p>By Kabwali Muuka</p>
      </footer>
    </div>
  </body>
</html>
